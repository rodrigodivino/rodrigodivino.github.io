import{S as t,i as n,s as e,e as r,t as i,a as o,b as a,f as u,g as s,d as c,c as l,h,z as f,j as d,k as p,n as g,B as v}from"./client.10c94a1d.js";var m="http://www.w3.org/1999/xhtml",y={svg:"http://www.w3.org/2000/svg",xhtml:m,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function _(t){var n=t+="",e=n.indexOf(":");return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),y.hasOwnProperty(n)?{space:y[n],local:t}:t}function w(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===m&&n.documentElement.namespaceURI===m?n.createElement(t):n.createElementNS(e,t)}}function x(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function A(t){var n=_(t);return(n.local?x:w)(n)}function b(){}function T(t){return null==t?b:function(){return this.querySelector(t)}}function k(){return[]}function C(t){return new Array(t.length)}function j(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}j.prototype={constructor:j,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function N(t,n,e,r,i,o){for(var a,u=0,s=n.length,c=o.length;u<c;++u)(a=n[u])?(a.__data__=o[u],r[u]=a):e[u]=new j(t,o[u]);for(;u<s;++u)(a=n[u])&&(i[u]=a)}function S(t,n,e,r,i,o,a){var u,s,c,l={},h=n.length,f=o.length,d=new Array(h);for(u=0;u<h;++u)(s=n[u])&&(d[u]=c="$"+a.call(s,s.__data__,u,n),c in l?i[u]=s:l[c]=s);for(u=0;u<f;++u)(s=l[c="$"+a.call(t,o[u],u,o)])?(r[u]=s,s.__data__=o[u],l[c]=null):e[u]=new j(t,o[u]);for(u=0;u<h;++u)(s=n[u])&&l[d[u]]===s&&(i[u]=s)}function $(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function D(t){return function(){this.removeAttribute(t)}}function E(t){return function(){this.removeAttributeNS(t.space,t.local)}}function B(t,n){return function(){this.setAttribute(t,n)}}function H(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function M(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}function P(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function q(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function z(t){return function(){this.style.removeProperty(t)}}function U(t,n,e){return function(){this.style.setProperty(t,n,e)}}function L(t,n,e){return function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}function O(t,n){return t.style.getPropertyValue(n)||q(t).getComputedStyle(t,null).getPropertyValue(n)}function R(t){return function(){delete this[t]}}function I(t,n){return function(){this[t]=n}}function W(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}function V(t){return t.trim().split(/^|\s+/)}function Z(t){return t.classList||new F(t)}function F(t){this._node=t,this._names=V(t.getAttribute("class")||"")}function J(t,n){for(var e=Z(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function K(t,n){for(var e=Z(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function X(t){return function(){J(this,t)}}function Y(t){return function(){K(this,t)}}function G(t,n){return function(){(n.apply(this,arguments)?J:K)(this,t)}}function Q(){this.textContent=""}function tt(t){return function(){this.textContent=t}}function nt(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}function et(){this.innerHTML=""}function rt(t){return function(){this.innerHTML=t}}function it(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}function ot(){this.nextSibling&&this.parentNode.appendChild(this)}function at(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ut(){return null}function st(){var t=this.parentNode;t&&t.removeChild(this)}function ct(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function lt(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}F.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var ht={};"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(ht={mouseenter:"mouseover",mouseleave:"mouseout"}));function ft(t,n,e){return t=dt(t,n,e),function(n){var e=n.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||t.call(this,n)}}function dt(t,n,e){return function(r){try{t.call(this,this.__data__,n,e)}finally{}}}function pt(t){return t.trim().split(/^|\s+/).map((function(t){var n="",e=t.indexOf(".");return e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}}))}function gt(t){return function(){var n=this.__on;if(n){for(var e,r=0,i=-1,o=n.length;r<o;++r)e=n[r],t.type&&e.type!==t.type||e.name!==t.name?n[++i]=e:this.removeEventListener(e.type,e.listener,e.capture);++i?n.length=i:delete this.__on}}}function vt(t,n,e){var r=ht.hasOwnProperty(t.type)?ft:dt;return function(i,o,a){var u,s=this.__on,c=r(n,o,a);if(s)for(var l=0,h=s.length;l<h;++l)if((u=s[l]).type===t.type&&u.name===t.name)return this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=c,u.capture=e),void(u.value=n);this.addEventListener(t.type,c,e),u={type:t.type,name:t.name,value:n,listener:c,capture:e},s?s.push(u):this.__on=[u]}}function mt(t,n,e){var r=q(t),i=r.CustomEvent;"function"==typeof i?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}function yt(t,n){return function(){return mt(this,t,n)}}function _t(t,n){return function(){return mt(this,t,n.apply(this,arguments))}}var wt=[null];function xt(t,n){this._groups=t,this._parents=n}function At(t){return"string"==typeof t?new xt([[document.querySelector(t)]],[document.documentElement]):new xt([[t]],wt)}xt.prototype=function(){return new xt([[document.documentElement]],wt)}.prototype={constructor:xt,select:function(t){"function"!=typeof t&&(t=T(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a,u=n[i],s=u.length,c=r[i]=new Array(s),l=0;l<s;++l)(o=u[l])&&(a=t.call(o,o.__data__,l,u))&&("__data__"in o&&(a.__data__=o.__data__),c[l]=a);return new xt(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=function(t){return null==t?k:function(){return this.querySelectorAll(t)}}(t));for(var n=this._groups,e=n.length,r=[],i=[],o=0;o<e;++o)for(var a,u=n[o],s=u.length,c=0;c<s;++c)(a=u[c])&&(r.push(t.call(a,a.__data__,c,u)),i.push(a));return new xt(r,i)},filter:function(t){"function"!=typeof t&&(t=function(t){return function(){return this.matches(t)}}(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a=n[i],u=a.length,s=r[i]=[],c=0;c<u;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&s.push(o);return new xt(r,this._parents)},data:function(t,n){if(!t)return p=new Array(this.size()),l=-1,this.each((function(t){p[++l]=t})),p;var e,r=n?S:N,i=this._parents,o=this._groups;"function"!=typeof t&&(e=t,t=function(){return e});for(var a=o.length,u=new Array(a),s=new Array(a),c=new Array(a),l=0;l<a;++l){var h=i[l],f=o[l],d=f.length,p=t.call(h,h&&h.__data__,l,i),g=p.length,v=s[l]=new Array(g),m=u[l]=new Array(g);r(h,f,v,m,c[l]=new Array(d),p,n);for(var y,_,w=0,x=0;w<g;++w)if(y=v[w]){for(w>=x&&(x=w+1);!(_=m[x])&&++x<g;);y._next=_||null}}return(u=new xt(u,i))._enter=s,u._exit=c,u},enter:function(){return new xt(this._enter||this._groups.map(C),this._parents)},exit:function(){return new xt(this._exit||this._groups.map(C),this._parents)},join:function(t,n,e){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=n&&(i=n(i)),null==e?o.remove():e(o),r&&i?r.merge(i).order():i},merge:function(t){for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var s,c=n[u],l=e[u],h=c.length,f=a[u]=new Array(h),d=0;d<h;++d)(s=c[d]||l[d])&&(f[d]=s);for(;u<r;++u)a[u]=n[u];return new xt(a,this._parents)},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r,i=t[n],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function n(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}t||(t=$);for(var e=this._groups,r=e.length,i=new Array(r),o=0;o<r;++o){for(var a,u=e[o],s=u.length,c=i[o]=new Array(s),l=0;l<s;++l)(a=u[l])&&(c[l]=a);c.sort(n)}return new xt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),n=-1;return this.each((function(){t[++n]=this})),t},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i,o=n[e],a=0,u=o.length;a<u;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,n){var e=_(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((null==n?e.local?E:D:"function"==typeof n?e.local?P:M:e.local?H:B)(e,n))},style:function(t,n,e){return arguments.length>1?this.each((null==n?z:"function"==typeof n?L:U)(t,n,null==e?"":e)):O(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?R:"function"==typeof n?W:I)(t,n)):this.node()[t]},classed:function(t,n){var e=V(t+"");if(arguments.length<2){for(var r=Z(this.node()),i=-1,o=e.length;++i<o;)if(!r.contains(e[i]))return!1;return!0}return this.each(("function"==typeof n?G:n?X:Y)(e,n))},text:function(t){return arguments.length?this.each(null==t?Q:("function"==typeof t?nt:tt)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?et:("function"==typeof t?it:rt)(t)):this.node().innerHTML},raise:function(){return this.each(ot)},lower:function(){return this.each(at)},append:function(t){var n="function"==typeof t?t:A(t);return this.select((function(){return this.appendChild(n.apply(this,arguments))}))},insert:function(t,n){var e="function"==typeof t?t:A(t),r=null==n?ut:"function"==typeof n?n:T(n);return this.select((function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(st)},clone:function(t){return this.select(t?lt:ct)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var r,i,o=pt(t+""),a=o.length;if(!(arguments.length<2)){for(u=n?vt:gt,null==e&&(e=!1),r=0;r<a;++r)this.each(u(o[r],n,e));return this}var u=this.node().__on;if(u)for(var s,c=0,l=u.length;c<l;++c)for(r=0,s=u[c];r<a;++r)if((i=o[r]).type===s.type&&i.name===s.name)return s.value},dispatch:function(t,n){return this.each(("function"==typeof n?_t:yt)(t,n))}};var bt={},Tt={};function kt(t){return new Function("d","return {"+t.map((function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'})).join(",")+"}")}function Ct(t){var n=Object.create(null),e=[];return t.forEach((function(t){for(var r in t)r in n||e.push(n[r]=r)})),e}function jt(t,n){var e=t+"",r=e.length;return r<n?new Array(n-r+1).join(0)+e:e}function Nt(t){var n,e=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((n=t.getUTCFullYear())<0?"-"+jt(-n,6):n>9999?"+"+jt(n,6):jt(n,4))+"-"+jt(t.getUTCMonth()+1,2)+"-"+jt(t.getUTCDate(),2)+(o?"T"+jt(e,2)+":"+jt(r,2)+":"+jt(i,2)+"."+jt(o,3)+"Z":i?"T"+jt(e,2)+":"+jt(r,2)+":"+jt(i,2)+"Z":r||e?"T"+jt(e,2)+":"+jt(r,2)+"Z":"")}var St=function(t){var n=new RegExp('["'+t+"\n\r]"),e=t.charCodeAt(0);function r(t,n){var r,i=[],o=t.length,a=0,u=0,s=o<=0,c=!1;function l(){if(s)return Tt;if(c)return c=!1,bt;var n,r,i=a;if(34===t.charCodeAt(i)){for(;a++<o&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(n=a)>=o?s=!0:10===(r=t.charCodeAt(a++))?c=!0:13===r&&(c=!0,10===t.charCodeAt(a)&&++a),t.slice(i+1,n-1).replace(/""/g,'"')}for(;a<o;){if(10===(r=t.charCodeAt(n=a++)))c=!0;else if(13===r)c=!0,10===t.charCodeAt(a)&&++a;else if(r!==e)continue;return t.slice(i,n)}return s=!0,t.slice(i,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(r=l())!==Tt;){for(var h=[];r!==bt&&r!==Tt;)h.push(r),r=l();n&&null==(h=n(h,u++))||i.push(h)}return i}function i(n,e){return n.map((function(n){return e.map((function(t){return a(n[t])})).join(t)}))}function o(n){return n.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?Nt(t):n.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,n){var e,i,o=r(t,(function(t,r){if(e)return e(t,r-1);i=t,e=n?function(t,n){var e=kt(t);return function(r,i){return n(e(r),i,t)}}(t,n):kt(t)}));return o.columns=i||[],o},parseRows:r,format:function(n,e){return null==e&&(e=Ct(n)),[e.map(a).join(t)].concat(i(n,e)).join("\n")},formatBody:function(t,n){return null==n&&(n=Ct(t)),i(t,n).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}}("\t").parse;function $t(t){for(var n in t){var e,r,i=t[n].trim();if(i)if("true"===i)i=!0;else if("false"===i)i=!1;else if("NaN"===i)i=NaN;else if(isNaN(e=+i)){if(!(r=i.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;Dt&&r[4]&&!r[7]&&(i=i.replace(/-/g,"/").replace(/T/," ")),i=new Date(i)}else i=e;else i=null;t[n]=i}return t}var Dt=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function Et(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function Bt(t,n){return fetch(t,n).then(Et)}var Ht,Mt=(Ht=St,function(t,n,e){return 2===arguments.length&&"function"==typeof n&&(e=n,n=void 0),Bt(t,n).then((function(t){return Ht(t,e)}))});function Pt(t,n){let e=0;if(void 0===n)for(let n of t)(n=+n)&&(e+=n);else{let r=-1;for(let i of t)(i=+n(i,++r,t))&&(e+=i)}return e}function qt(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t)}return this}const zt=Symbol("implicit");var Ut=function(t){for(var n=t.length/6|0,e=new Array(n),r=0;r<n;)e[r]="#"+t.slice(6*r,6*++r);return e}("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function Lt(){}function Ot(t,n){var e=new Lt;if(t instanceof Lt)t.each((function(t,n){e.set(n,t)}));else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==n)for(;++i<o;)e.set(i,t[i]);else for(;++i<o;)e.set(n(r=t[i],i,t),r)}else if(t)for(var a in t)e.set(a,t[a]);return e}function Rt(){var t,n,e,r=[],i=[];function o(e,i,a,u){if(i>=r.length)return null!=t&&e.sort(t),null!=n?n(e):e;for(var s,c,l,h=-1,f=e.length,d=r[i++],p=Ot(),g=a();++h<f;)(l=p.get(s=d(c=e[h])+""))?l.push(c):p.set(s,[c]);return p.each((function(t,n){u(g,n,o(t,i,a,u))})),g}return e={object:function(t){return o(t,0,It,Wt)},map:function(t){return o(t,0,Vt,Zt)},entries:function(t){return function t(e,o){if(++o>r.length)return e;var a,u=i[o-1];return null!=n&&o>=r.length?a=e.entries():(a=[],e.each((function(n,e){a.push({key:e,values:t(n,o)})}))),null!=u?a.sort((function(t,n){return u(t.key,n.key)})):a}(o(t,0,Vt,Zt),0)},key:function(t){return r.push(t),e},sortKeys:function(t){return i[r.length-1]=t,e},sortValues:function(n){return t=n,e},rollup:function(t){return n=t,e}}}function It(){return{}}function Wt(t,n,e){t[n]=e}function Vt(){return Ot()}function Zt(t,n,e){t.set(n,e)}function Ft(){}Lt.prototype=Ot.prototype={constructor:Lt,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,n){return this["$"+t]=n,this},remove:function(t){var n="$"+t;return n in this&&delete this[n]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var n in this)"$"===n[0]&&t.push(n.slice(1));return t},values:function(){var t=[];for(var n in this)"$"===n[0]&&t.push(this[n]);return t},entries:function(){var t=[];for(var n in this)"$"===n[0]&&t.push({key:n.slice(1),value:this[n]});return t},size:function(){var t=0;for(var n in this)"$"===n[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var n in this)"$"===n[0]&&t(this[n],n.slice(1),this)}};var Jt=Ot.prototype;function Kt(t){var n=0,e=t.children,r=e&&e.length;if(r)for(;--r>=0;)n+=e[r].value;else n=1;t.value=n}function Xt(t,n){var e,r,i,o,a,u=new tn(t),s=+t.value&&(u.value=t.value),c=[u];for(null==n&&(n=Yt);e=c.pop();)if(s&&(e.value=+e.data.value),(i=n(e.data))&&(a=i.length))for(e.children=new Array(a),o=a-1;o>=0;--o)c.push(r=e.children[o]=new tn(i[o])),r.parent=e,r.depth=e.depth+1;return u.eachBefore(Qt)}function Yt(t){return t.children}function Gt(t){t.data=t.data.data}function Qt(t){var n=0;do{t.height=n}while((t=t.parent)&&t.height<++n)}function tn(t){this.data=t,this.depth=this.height=0,this.parent=null}function nn(t){if("function"!=typeof t)throw new Error;return t}function en(){return 0}function rn(t){return function(){return t}}function on(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function an(t,n,e,r,i){for(var o,a=t.children,u=-1,s=a.length,c=t.value&&(r-n)/t.value;++u<s;)(o=a[u]).y0=e,o.y1=i,o.x0=n,o.x1=n+=o.value*c}function un(t,n,e,r,i){for(var o,a=t.children,u=-1,s=a.length,c=t.value&&(i-e)/t.value;++u<s;)(o=a[u]).x0=n,o.x1=r,o.y0=e,o.y1=e+=o.value*c}Ft.prototype=function(t,n){var e=new Ft;if(t instanceof Ft)t.each((function(t){e.add(t)}));else if(t){var r=-1,i=t.length;if(null==n)for(;++r<i;)e.add(t[r]);else for(;++r<i;)e.add(n(t[r],r,t))}return e}.prototype={constructor:Ft,has:Jt.has,add:function(t){return this["$"+(t+="")]=t,this},remove:Jt.remove,clear:Jt.clear,values:Jt.keys,size:Jt.size,empty:Jt.empty,each:Jt.each},tn.prototype=Xt.prototype={constructor:tn,count:function(){return this.eachAfter(Kt)},each:function(t){var n,e,r,i,o=this,a=[o];do{for(n=a.reverse(),a=[];o=n.pop();)if(t(o),e=o.children)for(r=0,i=e.length;r<i;++r)a.push(e[r])}while(a.length);return this},eachAfter:function(t){for(var n,e,r,i=this,o=[i],a=[];i=o.pop();)if(a.push(i),n=i.children)for(e=0,r=n.length;e<r;++e)o.push(n[e]);for(;i=a.pop();)t(i);return this},eachBefore:function(t){for(var n,e,r=this,i=[r];r=i.pop();)if(t(r),n=r.children)for(e=n.length-1;e>=0;--e)i.push(n[e]);return this},sum:function(t){return this.eachAfter((function(n){for(var e=+t(n.data)||0,r=n.children,i=r&&r.length;--i>=0;)e+=r[i].value;n.value=e}))},sort:function(t){return this.eachBefore((function(n){n.children&&n.children.sort(t)}))},path:function(t){for(var n=this,e=function(t,n){if(t===n)return t;var e=t.ancestors(),r=n.ancestors(),i=null;t=e.pop(),n=r.pop();for(;t===n;)i=t,t=e.pop(),n=r.pop();return i}(n,t),r=[n];n!==e;)n=n.parent,r.push(n);for(var i=r.length;t!==e;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,n=[t];t=t.parent;)n.push(t);return n},descendants:function(){var t=[];return this.each((function(n){t.push(n)})),t},leaves:function(){var t=[];return this.eachBefore((function(n){n.children||t.push(n)})),t},links:function(){var t=this,n=[];return t.each((function(e){e!==t&&n.push({source:e.parent,target:e})})),n},copy:function(){return Xt(this).eachBefore(Gt)}};var sn=function t(n){function e(t,e,r,i,o){!function(t,n,e,r,i,o){for(var a,u,s,c,l,h,f,d,p,g,v,m=[],y=n.children,_=0,w=0,x=y.length,A=n.value;_<x;){s=i-e,c=o-r;do{l=y[w++].value}while(!l&&w<x);for(h=f=l,v=l*l*(g=Math.max(c/s,s/c)/(A*t)),p=Math.max(f/v,v/h);w<x;++w){if(l+=u=y[w].value,u<h&&(h=u),u>f&&(f=u),v=l*l*g,(d=Math.max(f/v,v/h))>p){l-=u;break}p=d}m.push(a={value:l,dice:s<c,children:y.slice(_,w)}),a.dice?an(a,e,r,i,A?r+=c*l/A:o):un(a,e,r,A?e+=s*l/A:i,o),A-=l,_=w}}(n,t,e,r,i,o)}return e.ratio=function(n){return t((n=+n)>1?n:1)},e}((1+Math.sqrt(5))/2);function cn(t){let n,e,v,m,y,_,w;return{c(){n=r("h1"),e=i("Treemap"),v=o(),m=r("p"),y=i("The hierarchical nature of Treemaps are well suited to overview resource\n  allocation. This implementation shows how hours are distributed accross\n  Clients, Projects, Tasks, and Tools"),_=o(),w=r("div"),this.h()},l(t){n=a(t,"H1",{});var r=u(n);e=s(r,"Treemap"),r.forEach(c),v=l(t),m=a(t,"P",{});var i=u(m);y=s(i,"The hierarchical nature of Treemaps are well suited to overview resource\n  allocation. This implementation shows how hours are distributed accross\n  Clients, Projects, Tasks, and Tools"),i.forEach(c),_=l(t),w=a(t,"DIV",{id:!0,style:!0}),u(w).forEach(c),this.h()},h(){h(w,"id","treemap_canvas"),f(w,"width","90vw"),f(w,"height","95vh"),f(w,"margin","auto")},m(r,i){d(r,n,i),p(n,e),d(r,v,i),d(r,m,i),p(m,y),d(r,_,i),d(r,w,i),t[3](w)},p:g,i:g,o:g,d(e){e&&c(n),e&&c(v),e&&c(m),e&&c(_),e&&c(w),t[3](null)}}}function ln(t,n,e){class r{constructor(t,n){this.params={paddingTop:.03,urgencyBorder:8},this.div=At("div#"+t),this.width=this.div.node().clientWidth,this.height=this.div.node().clientHeight,this.margin={top:0,left:10,right:4,bottom:50},this.innerWidth=this.width-this.margin.left-this.margin.right,this.innerHeight=this.height-this.margin.top-this.margin.bottom,this.data=this.aggregate(n),this.colorDomain=this._unique(this.data.map(t=>t.Tool)),this.colorScale=function t(){var n=new Map,e=[],r=[],i=zt;function o(t){var o=t+"",a=n.get(o);if(!a){if(i!==zt)return i;n.set(o,a=e.push(t))}return r[(a-1)%r.length]}return o.domain=function(t){if(!arguments.length)return e.slice();e=[],n=new Map;for(const r of t){const t=r+"";n.has(t)||n.set(t,e.push(r))}return o},o.range=function(t){return arguments.length?(r=Array.from(t),o):r.slice()},o.unknown=function(t){return arguments.length?(i=t,o):i},o.copy=function(){return t(e,r).unknown(i)},qt.apply(o,arguments),o}().domain(this.colorDomain).range(Ut.filter((t,n)=>2!==n)),[this.rectData,this.maxDepth]=this.getRectData(this.data,this.innerWidth,this.innerHeight),this.svg=this.div.append("svg").attr("width",this.width).attr("height",this.height),this.plot=this.svg.append("g").attr("transform",`translate(${this.margin.left}, ${this.margin.top})`),this.render()}getRectData(t,n,e){const r=Xt({key:"root",values:Rt().key(t=>t.Client).key(t=>t.Project).key(t=>t.Section).entries(t)},t=>t.values).sum(t=>t.Hours),i=function(){var t=sn,n=!1,e=1,r=1,i=[0],o=en,a=en,u=en,s=en,c=en;function l(t){return t.x0=t.y0=0,t.x1=e,t.y1=r,t.eachBefore(h),i=[0],n&&t.eachBefore(on),t}function h(n){var e=i[n.depth],r=n.x0+e,l=n.y0+e,h=n.x1-e,f=n.y1-e;h<r&&(r=h=(r+h)/2),f<l&&(l=f=(l+f)/2),n.x0=r,n.y0=l,n.x1=h,n.y1=f,n.children&&(e=i[n.depth+1]=o(n)/2,r+=c(n)-e,l+=a(n)-e,(h-=u(n)-e)<r&&(r=h=(r+h)/2),(f-=s(n)-e)<l&&(l=f=(l+f)/2),t(n,r,l,h,f))}return l.round=function(t){return arguments.length?(n=!!t,l):n},l.size=function(t){return arguments.length?(e=+t[0],r=+t[1],l):[e,r]},l.tile=function(n){return arguments.length?(t=nn(n),l):t},l.padding=function(t){return arguments.length?l.paddingInner(t).paddingOuter(t):l.paddingInner()},l.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:rn(+t),l):o},l.paddingOuter=function(t){return arguments.length?l.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):l.paddingTop()},l.paddingTop=function(t){return arguments.length?(a="function"==typeof t?t:rn(+t),l):a},l.paddingRight=function(t){return arguments.length?(u="function"==typeof t?t:rn(+t),l):u},l.paddingBottom=function(t){return arguments.length?(s="function"==typeof t?t:rn(+t),l):s},l.paddingLeft=function(t){return arguments.length?(c="function"==typeof t?t:rn(+t),l):c},l}().tile(sn.ratio(1)).paddingInner(2).paddingTop(this.params.paddingTop*innerHeight).size([this.innerWidth,this.innerHeight])(r),o=i.leaves()[0].depth;return[i,o]}aggregate(t){const n=Rt().key(t=>t.Client).key(t=>t.Project).key(t=>t.Section).key(t=>t.Tool).entries(t),e=(t,n)=>{if(t[0].hasOwnProperty("key"))for(let r=0;r<t.length;r++){const i=t[r];e(i.values,n)}else n.push(t)},r=[];e(n,r),console.log(r);return r.map(t=>{const n=Pt(t,t=>t.Hours),e=t.map(t=>t.Urgency).some(t=>this._stringEqual(t,"urgent"));return{Client:t[0].Client,Project:t[0].Project,Section:t[0].Section,Tool:t[0].Tool,Hours:n,Urgency:e?"urgent":"no",raw_data:t}})}render(){this.plot.selectAll("rect.masterBorder").data([null]).join("rect").classed("masterBorder",!0).attr("y",this.innerHeight*this.params.paddingTop).attr("width",this.innerWidth).attr("height",this.innerHeight-this.innerHeight*this.params.paddingTop).attr("stroke","black").attr("fill","white").attr("stroke-width",0);const t=this.plot.selectAll("g.background").data(this.rectData.descendants().filter(t=>0!==t.depth&&t.depth!==this.maxDepth)).join("g").classed("background",!0).attr("transform",t=>`translate(${t.x0},${t.y0})`),n=this.plot.selectAll("g.cell").data(this.rectData.leaves()).join("g").classed("cell",!0).attr("transform",t=>`translate(${t.x0},${t.y0})`);n.selectAll("rect").data(t=>[t]).join("rect").attr("width",t=>t.x1-t.x0).attr("height",t=>t.y1-t.y0).style("fill",t=>this.colorScale(t.data.Tool)),n.selectAll("text.squareNumber").data(t=>[t]).join("text").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-family","sans-serif").classed("squareNumber",!0).attr("x",t=>(t.x1-t.x0)/2).attr("y",t=>2+(t.y1-t.y0)/2).text((function(t){return t.value})).attr("font-size",t=>{const n=(t.x1-t.x0)*(t.y1-t.y0);return.4*Math.sqrt(n)}).attr("fill",t=>this._stringEqual(t.data.Urgency,"urgent")?"firebrick":"white"),t.selectAll("rect.descendants").data(t=>[t]).join("rect").classed("descendants",!0).attr("width",t=>t.x1-t.x0).attr("height",innerHeight*this.params.paddingTop).style("stroke","lightgray").attr("stroke-width",1).attr("fill",t=>1===t.depth?"black":2===t.depth?"lightgray":"white").selectAll("title").data(t=>[t]).join("title").text(t=>t.data.key),t.selectAll("text.descendants").data(t=>[t]).join("text").classed("descendants",!0).join("text").classed("descendants",!0).attr("font-family","sans-serif").attr("text-anchor","middle").attr("y",2+innerHeight*this.params.paddingTop/2).attr("x",t=>(t.x1-t.x0)/2).text(t=>t.data.key).attr("alignment-baseline","middle").attr("font-size",18).attr("font-weight",t=>{if(1===t.depth)return"bolder"}).attr("fill",t=>1===t.depth?"white":"black").attr("pointer-events","none"),t.selectAll("text.descendants").each((function(){this.getBBox().width>At(this.parentNode).select("rect.descendants").node().getBBox().width&&At(this).text("...").attr("font-size",16)}));const e=this.plot.selectAll("g.colorLegend").data([null]).join("g").classed("colorLegend",!0).attr("transform",`translate(-2.5,${this.innerHeight+2})`),r=e.selectAll("g").data(this.colorDomain).join("g").attr("transform",(t,n)=>`translate(${n*(this.innerWidth/this.colorDomain.length)},0)`);r.selectAll("rect.color").data(t=>[t]).join("rect").classed("color",!0).attr("x",5).attr("y",(this.margin.bottom-2)/2).attr("width",this.innerWidth/this.colorDomain.length-5).attr("stroke","black").attr("height",(this.margin.bottom-2)/2-2).attr("fill",t=>this.colorScale(t)),r.selectAll("text.label").data(t=>[t]).join("text").attr("font-family","sans-serif").classed("label",!0).attr("y",1+(this.margin.bottom-2)/4+(this.margin.bottom-2)/2).attr("x",this.innerWidth/this.colorDomain.length/2).text(t=>{const n=Pt(this.data.filter(n=>n.Tool===t),t=>t.Hours);return`${t}: ${n}`}).attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",18).attr("font-weight","bold"),e.selectAll("text.title").data([null]).join("text").attr("font-family","sans-serif").text("Tools").attr("text-anchor","middle").attr("x",this.innerWidth/2).attr("alignment-baseline","middle").attr("y",this.margin.bottom/4).attr("font-size",18).attr("font-weight","bold")}_unique(t){return t.filter((t,n,e)=>e.indexOf(t)===n)}_stringEqual(t,n){return t.toUpperCase()===n.toUpperCase()}}let i,o;return t.$$.update=()=>{1&t.$$.dirty&&i&&Mt("vizzes/treemap/data.tsv",$t).then(t=>{o=new r("treemap_canvas",t)})},[i,o,r,function(t){v[t?"unshift":"push"](()=>{e(0,i=t)})}]}export default class extends t{constructor(t){super(),n(this,t,ln,cn,e,{})}}
